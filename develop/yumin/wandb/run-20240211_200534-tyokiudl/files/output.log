/opt/conda/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:136: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
2024-02-11 20:07:13 | Epoch [1/150], Step [25/39], Loss: 0.0848, lr: 0.0009045
2024-02-11 20:09:00 | Epoch [2/150], Step [25/39], Loss: 0.03, lr: 0.0006545
2024-02-11 20:10:47 | Epoch [3/150], Step [25/39], Loss: 0.0224, lr: 0.0003456
2024-02-11 20:12:33 | Epoch [4/150], Step [25/39], Loss: 0.0196, lr: 0.0000956
2024-02-11 20:14:20 | Epoch [5/150], Step [25/39], Loss: 0.0185, lr: 0.0000001
2024-02-11 20:16:05 | Epoch [6/150], Step [25/39], Loss: 0.0177, lr: 0.0000956
2024-02-11 20:17:54 | Epoch [7/150], Step [25/39], Loss: 0.0143, lr: 0.0003456
2024-02-11 20:19:38 | Epoch [8/150], Step [25/39], Loss: 0.0109, lr: 0.0006545
2024-02-11 20:21:26 | Epoch [9/150], Step [25/39], Loss: 0.0074, lr: 0.0009045
2024-02-11 20:23:14 | Epoch [10/150], Step [25/39], Loss: 0.0054, lr: 0.0010000
Start validation #10












































































 99%|██████████████████████████████████████████████████████████████████▏| 78/79 [05:30<00:04,  4.21s/it]
current valid Dice: 0.6604
Best performance at epoch: 10, 0.0000 -> 0.6604

100%|███████████████████████████████████████████████████████████████████| 79/79 [05:34<00:00,  4.24s/it]
2024-02-11 20:30:28 | Epoch [11/150], Step [25/39], Loss: 0.0042, lr: 0.0009045
2024-02-11 20:32:05 | Epoch [12/150], Step [25/39], Loss: 0.0037, lr: 0.0006545
2024-02-11 20:33:39 | Epoch [13/150], Step [25/39], Loss: 0.0035, lr: 0.0003456
2024-02-11 20:35:14 | Epoch [14/150], Step [25/39], Loss: 0.0033, lr: 0.0000956
2024-02-11 20:36:52 | Epoch [15/150], Step [25/39], Loss: 0.0033, lr: 0.0000001
2024-02-11 20:38:28 | Epoch [16/150], Step [25/39], Loss: 0.0031, lr: 0.0000956
2024-02-11 20:40:05 | Epoch [17/150], Step [25/39], Loss: 0.003, lr: 0.0003456
2024-02-11 20:41:37 | Epoch [18/150], Step [25/39], Loss: 0.0029, lr: 0.0006545
2024-02-11 20:43:17 | Epoch [19/150], Step [25/39], Loss: 0.0027, lr: 0.0009045
2024-02-11 20:44:53 | Epoch [20/150], Step [25/39], Loss: 0.0041, lr: 0.0010000
Start validation #20














































































 99%|██████████████████████████████████████████████████████████████████▏| 78/79 [05:30<00:04,  4.24s/it]

100%|███████████████████████████████████████████████████████████████████| 79/79 [05:34<00:00,  4.24s/it]
2024-02-11 20:52:05 | Epoch [21/150], Step [25/39], Loss: 0.0026, lr: 0.0009045
2024-02-11 20:53:39 | Epoch [22/150], Step [25/39], Loss: 0.0022, lr: 0.0006545
2024-02-11 20:55:16 | Epoch [23/150], Step [25/39], Loss: 0.0021, lr: 0.0003456
2024-02-11 20:56:53 | Epoch [24/150], Step [25/39], Loss: 0.0019, lr: 0.0000956
2024-02-11 20:58:29 | Epoch [25/150], Step [25/39], Loss: 0.0019, lr: 0.0000001
2024-02-11 21:00:03 | Epoch [26/150], Step [25/39], Loss: 0.0019, lr: 0.0000956
2024-02-11 21:01:40 | Epoch [27/150], Step [25/39], Loss: 0.0019, lr: 0.0003456
2024-02-11 21:03:15 | Epoch [28/150], Step [25/39], Loss: 0.0018, lr: 0.0006545
2024-02-11 21:04:52 | Epoch [29/150], Step [25/39], Loss: 0.0016, lr: 0.0009045
2024-02-11 21:06:32 | Epoch [30/150], Step [25/39], Loss: 0.0015, lr: 0.0010000
  0%|                                                                            | 0/79 [00:00<?, ?it/s]















































































100%|███████████████████████████████████████████████████████████████████| 79/79 [05:33<00:00,  4.23s/it]
current valid Dice: 0.8886
Best performance at epoch: 30, 0.6604 -> 0.8886
Save model in save_dir
2024-02-11 21:13:45 | Epoch [31/150], Step [25/39], Loss: 0.0015, lr: 0.0009045
2024-02-11 21:15:21 | Epoch [32/150], Step [25/39], Loss: 0.0014, lr: 0.0006545
2024-02-11 21:16:55 | Epoch [33/150], Step [25/39], Loss: 0.0014, lr: 0.0003456
2024-02-11 21:18:31 | Epoch [34/150], Step [25/39], Loss: 0.0013, lr: 0.0000956
2024-02-11 21:20:09 | Epoch [35/150], Step [25/39], Loss: 0.0013, lr: 0.0000001
2024-02-11 21:21:45 | Epoch [36/150], Step [25/39], Loss: 0.0013, lr: 0.0000956
2024-02-11 21:23:22 | Epoch [37/150], Step [25/39], Loss: 0.0013, lr: 0.0003456
2024-02-11 21:24:59 | Epoch [38/150], Step [25/39], Loss: 0.0013, lr: 0.0006545
2024-02-11 21:26:32 | Epoch [39/150], Step [25/39], Loss: 0.0014, lr: 0.0009045
2024-02-11 21:28:09 | Epoch [40/150], Step [25/39], Loss: 0.0012, lr: 0.0010000
Start validation #40















































































100%|███████████████████████████████████████████████████████████████████| 79/79 [05:35<00:00,  4.25s/it]
current valid Dice: 0.8982
Best performance at epoch: 40, 0.8886 -> 0.8982
Save model in save_dir
2024-02-11 21:35:25 | Epoch [41/150], Step [25/39], Loss: 0.0014, lr: 0.0009045
2024-02-11 21:37:03 | Epoch [42/150], Step [25/39], Loss: 0.0014, lr: 0.0006545
2024-02-11 21:38:40 | Epoch [43/150], Step [25/39], Loss: 0.0012, lr: 0.0003456
2024-02-11 21:40:17 | Epoch [44/150], Step [25/39], Loss: 0.0012, lr: 0.0000956
2024-02-11 21:41:53 | Epoch [45/150], Step [25/39], Loss: 0.0012, lr: 0.0000001
2024-02-11 21:43:29 | Epoch [46/150], Step [25/39], Loss: 0.0012, lr: 0.0000956
2024-02-11 21:45:06 | Epoch [47/150], Step [25/39], Loss: 0.0012, lr: 0.0003456
2024-02-11 21:46:41 | Epoch [48/150], Step [25/39], Loss: 0.0012, lr: 0.0006545
2024-02-11 21:48:19 | Epoch [49/150], Step [25/39], Loss: 0.0012, lr: 0.0009045
2024-02-11 21:49:57 | Epoch [50/150], Step [25/39], Loss: 0.001, lr: 0.0010000
  0%|                                                                            | 0/79 [00:00<?, ?it/s]














































































 99%|██████████████████████████████████████████████████████████████████▏| 78/79 [05:29<00:04,  4.18s/it]
current valid Dice: 0.9102
Best performance at epoch: 50, 0.8982 -> 0.9102

100%|███████████████████████████████████████████████████████████████████| 79/79 [05:33<00:00,  4.23s/it]
2024-02-11 21:57:08 | Epoch [51/150], Step [25/39], Loss: 0.001, lr: 0.0009045
2024-02-11 21:58:45 | Epoch [52/150], Step [25/39], Loss: 0.001, lr: 0.0006545
2024-02-11 22:00:20 | Epoch [53/150], Step [25/39], Loss: 0.001, lr: 0.0003456
2024-02-11 22:01:57 | Epoch [54/150], Step [25/39], Loss: 0.001, lr: 0.0000956
2024-02-11 22:03:34 | Epoch [55/150], Step [25/39], Loss: 0.001, lr: 0.0000001
2024-02-11 22:05:11 | Epoch [56/150], Step [25/39], Loss: 0.001, lr: 0.0000956
2024-02-11 22:06:49 | Epoch [57/150], Step [25/39], Loss: 0.001, lr: 0.0003456
2024-02-11 22:08:24 | Epoch [58/150], Step [25/39], Loss: 0.001, lr: 0.0006545
2024-02-11 22:10:00 | Epoch [59/150], Step [25/39], Loss: 0.001, lr: 0.0009045
2024-02-11 22:11:37 | Epoch [60/150], Step [25/39], Loss: 0.001, lr: 0.0010000
  0%|                                                                            | 0/79 [00:00<?, ?it/s]














































































 99%|██████████████████████████████████████████████████████████████████▏| 78/79 [05:30<00:04,  4.20s/it]
current valid Dice: 0.9109
Best performance at epoch: 60, 0.9102 -> 0.9109

100%|███████████████████████████████████████████████████████████████████| 79/79 [05:35<00:00,  4.24s/it]
2024-02-11 22:18:49 | Epoch [61/150], Step [25/39], Loss: 0.0009, lr: 0.0009045
2024-02-11 22:20:25 | Epoch [62/150], Step [25/39], Loss: 0.0009, lr: 0.0006545
2024-02-11 22:22:00 | Epoch [63/150], Step [25/39], Loss: 0.0009, lr: 0.0003456
2024-02-11 22:23:36 | Epoch [64/150], Step [25/39], Loss: 0.0009, lr: 0.0000956
2024-02-11 22:25:12 | Epoch [65/150], Step [25/39], Loss: 0.0009, lr: 0.0000001
2024-02-11 22:26:48 | Epoch [66/150], Step [25/39], Loss: 0.0009, lr: 0.0000956
2024-02-11 22:28:26 | Epoch [67/150], Step [25/39], Loss: 0.0009, lr: 0.0003456
2024-02-11 22:30:04 | Epoch [68/150], Step [25/39], Loss: 0.0009, lr: 0.0006545
2024-02-11 22:31:40 | Epoch [69/150], Step [25/39], Loss: 0.0009, lr: 0.0009045
2024-02-11 22:33:16 | Epoch [70/150], Step [25/39], Loss: 0.0011, lr: 0.0010000
  0%|                                                                            | 0/79 [00:00<?, ?it/s]














































































 99%|██████████████████████████████████████████████████████████████████▏| 78/79 [05:29<00:04,  4.18s/it]
current valid Dice: 0.9143
Best performance at epoch: 70, 0.9109 -> 0.9143

100%|███████████████████████████████████████████████████████████████████| 79/79 [05:33<00:00,  4.22s/it]
2024-02-11 22:40:25 | Epoch [71/150], Step [25/39], Loss: 0.0009, lr: 0.0009045
2024-02-11 22:42:00 | Epoch [72/150], Step [25/39], Loss: 0.0009, lr: 0.0006545
2024-02-11 22:43:36 | Epoch [73/150], Step [25/39], Loss: 0.0008, lr: 0.0003456
2024-02-11 22:45:13 | Epoch [74/150], Step [25/39], Loss: 0.0008, lr: 0.0000956
2024-02-11 22:46:50 | Epoch [75/150], Step [25/39], Loss: 0.0008, lr: 0.0000001
2024-02-11 22:48:27 | Epoch [76/150], Step [25/39], Loss: 0.0008, lr: 0.0000956
2024-02-11 22:50:04 | Epoch [77/150], Step [25/39], Loss: 0.0008, lr: 0.0003456
2024-02-11 22:51:43 | Epoch [78/150], Step [25/39], Loss: 0.0008, lr: 0.0006545
2024-02-11 22:53:20 | Epoch [79/150], Step [25/39], Loss: 0.0008, lr: 0.0009045
2024-02-11 22:54:57 | Epoch [80/150], Step [25/39], Loss: 0.0008, lr: 0.0010000
Start validation #80














































































 99%|██████████████████████████████████████████████████████████████████▏| 78/79 [05:30<00:04,  4.20s/it]

100%|███████████████████████████████████████████████████████████████████| 79/79 [05:34<00:00,  4.23s/it]
2024-02-11 23:02:07 | Epoch [81/150], Step [25/39], Loss: 0.0015, lr: 0.0009045
2024-02-11 23:03:42 | Epoch [82/150], Step [25/39], Loss: 0.001, lr: 0.0006545
2024-02-11 23:05:19 | Epoch [83/150], Step [25/39], Loss: 0.001, lr: 0.0003456
2024-02-11 23:06:54 | Epoch [84/150], Step [25/39], Loss: 0.001, lr: 0.0000956
2024-02-11 23:08:30 | Epoch [85/150], Step [25/39], Loss: 0.0009, lr: 0.0000001
2024-02-11 23:10:07 | Epoch [86/150], Step [25/39], Loss: 0.0009, lr: 0.0000956
2024-02-11 23:11:44 | Epoch [87/150], Step [25/39], Loss: 0.0009, lr: 0.0003456
2024-02-11 23:13:21 | Epoch [88/150], Step [25/39], Loss: 0.0009, lr: 0.0006545
2024-02-11 23:14:57 | Epoch [89/150], Step [25/39], Loss: 0.0008, lr: 0.0009045
2024-02-11 23:16:35 | Epoch [90/150], Step [25/39], Loss: 0.0008, lr: 0.0010000
  0%|                                                                            | 0/79 [00:00<?, ?it/s]














































































 99%|██████████████████████████████████████████████████████████████████▏| 78/79 [05:22<00:04,  4.07s/it]

100%|███████████████████████████████████████████████████████████████████| 79/79 [05:27<00:00,  4.14s/it]
2024-02-11 23:23:41 | Epoch [91/150], Step [25/39], Loss: 0.0008, lr: 0.0009045
2024-02-11 23:25:20 | Epoch [92/150], Step [25/39], Loss: 0.0008, lr: 0.0006545
2024-02-11 23:26:59 | Epoch [93/150], Step [25/39], Loss: 0.0008, lr: 0.0003456
2024-02-11 23:28:38 | Epoch [94/150], Step [25/39], Loss: 0.0008, lr: 0.0000956
2024-02-11 23:30:11 | Epoch [95/150], Step [25/39], Loss: 0.0008, lr: 0.0000001
2024-02-11 23:31:51 | Epoch [96/150], Step [25/39], Loss: 0.0008, lr: 0.0000956
2024-02-11 23:33:27 | Epoch [97/150], Step [25/39], Loss: 0.0008, lr: 0.0003456
2024-02-11 23:34:59 | Epoch [98/150], Step [25/39], Loss: 0.0008, lr: 0.0006545
2024-02-11 23:36:39 | Epoch [99/150], Step [25/39], Loss: 0.0009, lr: 0.0009045
2024-02-11 23:38:16 | Epoch [100/150], Step [25/39], Loss: 0.0008, lr: 0.0010000
  0%|                                                                             | 0/79 [00:00<?, ?it/s]















































































100%|████████████████████████████████████████████████████████████████████| 79/79 [05:40<00:00,  4.31s/it]
current valid Dice: 0.9160
Best performance at epoch: 100, 0.9143 -> 0.9160
Save model in save_dir
2024-02-11 23:45:33 | Epoch [101/150], Step [25/39], Loss: 0.0008, lr: 0.0009045
2024-02-11 23:47:15 | Epoch [102/150], Step [25/39], Loss: 0.0009, lr: 0.0006545
2024-02-11 23:48:57 | Epoch [103/150], Step [25/39], Loss: 0.0009, lr: 0.0003456
2024-02-11 23:50:33 | Epoch [104/150], Step [25/39], Loss: 0.0008, lr: 0.0000956
2024-02-11 23:52:09 | Epoch [105/150], Step [25/39], Loss: 0.0008, lr: 0.0000001
2024-02-11 23:53:46 | Epoch [106/150], Step [25/39], Loss: 0.0008, lr: 0.0000956
2024-02-11 23:55:20 | Epoch [107/150], Step [25/39], Loss: 0.0008, lr: 0.0003456
2024-02-11 23:56:56 | Epoch [108/150], Step [25/39], Loss: 0.0008, lr: 0.0006545
2024-02-11 23:58:32 | Epoch [109/150], Step [25/39], Loss: 0.0009, lr: 0.0009045
2024-02-12 00:00:11 | Epoch [110/150], Step [25/39], Loss: 0.0009, lr: 0.0010000
Start validation #110














































































 99%|███████████████████████████████████████████████████████████████████▏| 78/79 [05:32<00:04,  4.16s/it]

100%|████████████████████████████████████████████████████████████████████| 79/79 [05:36<00:00,  4.26s/it]
2024-02-12 00:07:21 | Epoch [111/150], Step [25/39], Loss: 0.0008, lr: 0.0009045
2024-02-12 00:08:59 | Epoch [112/150], Step [25/39], Loss: 0.0008, lr: 0.0006545
2024-02-12 00:10:36 | Epoch [113/150], Step [25/39], Loss: 0.0008, lr: 0.0003456
2024-02-12 00:12:12 | Epoch [114/150], Step [25/39], Loss: 0.0007, lr: 0.0000956
2024-02-12 00:13:47 | Epoch [115/150], Step [25/39], Loss: 0.0011, lr: 0.0000001
Traceback (most recent call last):
  File "/data/ephemeral/home/level2-cv-semanticsegmentation-cv-10/develop/yumin/custom_res.py", line 388, in <module>
    train(model, train_loader, valid_loader, criterion, optimizer)
  File "/data/ephemeral/home/level2-cv-semanticsegmentation-cv-10/develop/yumin/custom_res.py", line 326, in train
    # scaler.scale(loss).backward()
  File "/opt/conda/lib/python3.10/site-packages/torch/_tensor.py", line 492, in backward
    torch.autograd.backward(
  File "/opt/conda/lib/python3.10/site-packages/torch/autograd/__init__.py", line 251, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt