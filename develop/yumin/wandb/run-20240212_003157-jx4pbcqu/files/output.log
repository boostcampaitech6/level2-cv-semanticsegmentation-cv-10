/opt/conda/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:136: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
2024-02-12 00:33:41 | Epoch [1/150], Step [25/39], Loss: 0.0832, lr: 0.0009045180463377549
2024-02-12 00:35:35 | Epoch [2/150], Step [25/39], Loss: 0.0298, lr: 0.0006545430463377549
2024-02-12 00:37:27 | Epoch [3/150], Step [25/39], Loss: 0.0246, lr: 0.000345556953662245
2024-02-12 00:39:18 | Epoch [4/150], Step [25/39], Loss: 0.0219, lr: 9.558195366224506e-05
2024-02-12 00:41:10 | Epoch [5/150], Step [25/39], Loss: 0.0213, lr: 1e-07
  0%|                                                                                                     | 0/40 [00:00<?, ?it/s]







































 98%|█████████████████████████████████████████████████████████████████████████████████████████▋  | 39/40 [05:26<00:08,  8.94s/it]
current valid Dice: 0.0437
Best performance at epoch: 5, 0.0000 -> 0.0437

100%|████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [05:32<00:00,  8.30s/it]
2024-02-12 00:48:26 | Epoch [6/150], Step [25/39], Loss: 0.0207, lr: 9.558195366224502e-05
2024-02-12 00:50:08 | Epoch [7/150], Step [25/39], Loss: 0.0174, lr: 0.00034555695366224516
2024-02-12 00:51:49 | Epoch [8/150], Step [25/39], Loss: 0.0121, lr: 0.0006545430463377552
2024-02-12 00:53:30 | Epoch [9/150], Step [25/39], Loss: 0.0083, lr: 0.0009045180463377555
2024-02-12 00:55:11 | Epoch [10/150], Step [25/39], Loss: 0.0058, lr: 0.0010000000000000007
  0%|                                                                                                                            | 0/40 [00:00<?, ?it/s]








































100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [05:26<00:00,  8.16s/it]
current valid Dice: 0.5967
Best performance at epoch: 10, 0.0437 -> 0.5967
Save model in save_dir
2024-02-12 01:02:21 | Epoch [11/150], Step [25/39], Loss: 0.0044, lr: 0.0009045180463377558
2024-02-12 01:04:04 | Epoch [12/150], Step [25/39], Loss: 0.0039, lr: 0.0006545430463377554
2024-02-12 01:05:46 | Epoch [13/150], Step [25/39], Loss: 0.0034, lr: 0.0003455569536622454
2024-02-12 01:07:25 | Epoch [14/150], Step [25/39], Loss: 0.0033, lr: 9.558195366224518e-05
2024-02-12 01:09:07 | Epoch [15/150], Step [25/39], Loss: 0.0033, lr: 1e-07
Start validation #15








































100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [05:27<00:00,  8.18s/it]
current valid Dice: 0.8242
Best performance at epoch: 15, 0.5967 -> 0.8242
Save model in save_dir
2024-02-12 01:16:19 | Epoch [16/150], Step [25/39], Loss: 0.0032, lr: 9.558195366224502e-05
2024-02-12 01:17:58 | Epoch [17/150], Step [25/39], Loss: 0.003, lr: 0.00034555695366224516
2024-02-12 01:19:42 | Epoch [18/150], Step [25/39], Loss: 0.0028, lr: 0.0006545430463377554
2024-02-12 01:21:26 | Epoch [19/150], Step [25/39], Loss: 0.0025, lr: 0.0009045180463377557
2024-02-12 01:23:18 | Epoch [20/150], Step [25/39], Loss: 0.0025, lr: 0.0010000000000000013
  0%|                                                                                                      | 0/40 [00:00<?, ?it/s]








































100%|█████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [05:32<00:00,  8.31s/it]
current valid Dice: 0.8808
Best performance at epoch: 20, 0.8242 -> 0.8808
Save model in save_dir
2024-02-12 01:30:33 | Epoch [21/150], Step [25/39], Loss: 0.002, lr: 0.0009045180463377562
2024-02-12 01:32:15 | Epoch [22/150], Step [25/39], Loss: 0.0019, lr: 0.0006545430463377569
2024-02-12 01:33:54 | Epoch [23/150], Step [25/39], Loss: 0.0017, lr: 0.00034555695366224575
2024-02-12 01:35:35 | Epoch [24/150], Step [25/39], Loss: 0.0017, lr: 9.558195366224533e-05
2024-02-12 01:37:16 | Epoch [25/150], Step [25/39], Loss: 0.0016, lr: 1e-07
Start validation #25








































100%|█████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [05:26<00:00,  8.15s/it]
current valid Dice: 0.8982
Best performance at epoch: 25, 0.8808 -> 0.8982
Save model in save_dir
2024-02-12 01:44:24 | Epoch [26/150], Step [25/39], Loss: 0.0017, lr: 9.558195366224502e-05
2024-02-12 01:46:05 | Epoch [27/150], Step [25/39], Loss: 0.0016, lr: 0.00034555695366224527
2024-02-12 01:47:45 | Epoch [28/150], Step [25/39], Loss: 0.0016, lr: 0.0006545430463377557
2024-02-12 01:49:27 | Epoch [29/150], Step [25/39], Loss: 0.0015, lr: 0.0009045180463377563
2024-02-12 01:51:06 | Epoch [30/150], Step [25/39], Loss: 0.0014, lr: 0.001000000000000002
  0%|                                                                                                      | 0/40 [00:00<?, ?it/s]








































100%|█████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [05:27<00:00,  8.20s/it]
current valid Dice: 0.9086
Best performance at epoch: 30, 0.8982 -> 0.9086
Save model in save_dir
2024-02-12 01:58:15 | Epoch [31/150], Step [25/39], Loss: 0.0014, lr: 0.0009045180463377569
2024-02-12 01:59:56 | Epoch [32/150], Step [25/39], Loss: 0.0013, lr: 0.0006545430463377565
2024-02-12 02:01:36 | Epoch [33/150], Step [25/39], Loss: 0.0013, lr: 0.0003455569536622461
2024-02-12 02:03:19 | Epoch [34/150], Step [25/39], Loss: 0.0012, lr: 9.558195366224549e-05
2024-02-12 02:05:01 | Epoch [35/150], Step [25/39], Loss: 0.0013, lr: 1e-07
  0%|                                                                                                      | 0/40 [00:00<?, ?it/s]








































100%|█████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [05:27<00:00,  8.19s/it]
current valid Dice: 0.9085
2024-02-12 02:12:09 | Epoch [36/150], Step [25/39], Loss: 0.0012, lr: 9.558195366224502e-05
2024-02-12 02:13:51 | Epoch [37/150], Step [25/39], Loss: 0.0012, lr: 0.0003455569536622454
2024-02-12 02:15:30 | Epoch [38/150], Step [25/39], Loss: 0.0012, lr: 0.000654543046337756
2024-02-12 02:17:14 | Epoch [39/150], Step [25/39], Loss: 0.0012, lr: 0.0009045180463377568
2024-02-12 02:18:56 | Epoch [40/150], Step [25/39], Loss: 0.0012, lr: 0.0010000000000000024
Start validation #40








































100%|█████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [05:26<00:00,  8.16s/it]
current valid Dice: 0.9043
2024-02-12 02:26:03 | Epoch [41/150], Step [25/39], Loss: 0.0011, lr: 0.0009045180463377584
2024-02-12 02:27:41 | Epoch [42/150], Step [25/39], Loss: 0.0011, lr: 0.0006545430463377569
2024-02-12 02:29:26 | Epoch [43/150], Step [25/39], Loss: 0.001, lr: 0.0003455569536622464
2024-02-12 02:31:07 | Epoch [44/150], Step [25/39], Loss: 0.0011, lr: 9.558195366224663e-05
2024-02-12 02:32:49 | Epoch [45/150], Step [25/39], Loss: 0.001, lr: 1e-07
  0%|                                                                                                      | 0/40 [00:00<?, ?it/s]








































100%|█████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [05:25<00:00,  8.14s/it]
current valid Dice: 0.9140
Best performance at epoch: 45, 0.9086 -> 0.9140
Save model in save_dir
2024-02-12 02:39:55 | Epoch [46/150], Step [25/39], Loss: 0.001, lr: 9.558195366224502e-05
2024-02-12 02:41:38 | Epoch [47/150], Step [25/39], Loss: 0.001, lr: 0.0003455569536622474
2024-02-12 02:43:17 | Epoch [48/150], Step [25/39], Loss: 0.0011, lr: 0.0006545430463377566
2024-02-12 02:44:59 | Epoch [49/150], Step [25/39], Loss: 0.0011, lr: 0.0009045180463377566
2024-02-12 02:46:39 | Epoch [50/150], Step [25/39], Loss: 0.001, lr: 0.0010000000000000035
Start validation #50








































100%|█████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [05:27<00:00,  8.20s/it]
current valid Dice: 0.9145
Best performance at epoch: 50, 0.9140 -> 0.9145
Save model in save_dir
2024-02-12 02:53:50 | Epoch [51/150], Step [25/39], Loss: 0.001, lr: 0.0009045180463377594
2024-02-12 02:55:32 | Epoch [52/150], Step [25/39], Loss: 0.0009, lr: 0.0006545430463377577
2024-02-12 02:57:13 | Epoch [53/150], Step [25/39], Loss: 0.0009, lr: 0.0003455569536622451
2024-02-12 02:58:54 | Epoch [54/150], Step [25/39], Loss: 0.0009, lr: 9.558195366224572e-05
2024-02-12 03:00:37 | Epoch [55/150], Step [25/39], Loss: 0.0009, lr: 1e-07
  0%|                                                                                        | 0/40 [00:00<?, ?it/s]








































100%|███████████████████████████████████████████████████████████████████████████████| 40/40 [05:32<00:00,  8.31s/it]
current valid Dice: 0.9132
2024-02-12 03:07:50 | Epoch [56/150], Step [25/39], Loss: 0.0008, lr: 9.558195366224502e-05
2024-02-12 03:09:35 | Epoch [57/150], Step [25/39], Loss: 0.0009, lr: 0.0003455569536622441
2024-02-12 03:11:18 | Epoch [58/150], Step [25/39], Loss: 0.0009, lr: 0.0006545430463377569
2024-02-12 03:13:02 | Epoch [59/150], Step [25/39], Loss: 0.0009, lr: 0.0009045180463377571
2024-02-12 03:14:45 | Epoch [60/150], Step [25/39], Loss: 0.0009, lr: 0.0010000000000000041
  0%|                                                                                        | 0/40 [00:00<?, ?it/s]







































 98%|█████████████████████████████████████████████████████████████████████████████  | 39/40 [05:27<00:08,  8.37s/it]

100%|███████████████████████████████████████████████████████████████████████████████| 40/40 [05:31<00:00,  8.29s/it]
2024-02-12 03:21:59 | Epoch [61/150], Step [25/39], Loss: 0.0055, lr: 0.000904518046337758
2024-02-12 03:23:44 | Epoch [62/150], Step [25/39], Loss: 0.002, lr: 0.0006545430463377583
2024-02-12 03:25:31 | Epoch [63/150], Step [25/39], Loss: 0.0014, lr: 0.00034555695366224554
2024-02-12 03:27:12 | Epoch [64/150], Step [25/39], Loss: 0.0012, lr: 9.558195366224594e-05
2024-02-12 03:28:56 | Epoch [65/150], Step [25/39], Loss: 0.0012, lr: 1e-07
Start validation #65







































 98%|████████████████████████████████████████████████████████████████████████▏ | 39/40 [05:30<00:08,  8.43s/it]

100%|██████████████████████████████████████████████████████████████████████████| 40/40 [05:34<00:00,  8.37s/it]
2024-02-12 03:36:16 | Epoch [66/150], Step [25/39], Loss: 0.0013, lr: 9.558195366224502e-05
2024-02-12 03:37:58 | Epoch [67/150], Step [25/39], Loss: 0.0012, lr: 0.0003455569536622442
2024-02-12 03:39:40 | Epoch [68/150], Step [25/39], Loss: 0.0011, lr: 0.0006545430463377571
Traceback (most recent call last):
  File "/data/ephemeral/home/level2-cv-semanticsegmentation-cv-10/develop/yumin/base_res.py", line 389, in <module>
    train(model, train_loader, valid_loader, criterion, optimizer)
  File "/data/ephemeral/home/level2-cv-semanticsegmentation-cv-10/develop/yumin/base_res.py", line 314, in train
    images, masks = images.cuda(), masks.cuda()
KeyboardInterrupt